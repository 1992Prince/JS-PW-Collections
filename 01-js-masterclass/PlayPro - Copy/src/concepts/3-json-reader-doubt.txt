Q - will utility testdatareader.ts can read json files starting and ending with curly braces and square brackets?


******************************code starts here *****************************

import fs from 'fs';
import { TEST_DATA_PATH } from '../constants/constants';


const testDataPath = TEST_DATA_PATH;
//const testDataPath = "D://2025//17-sid-pw-course//JS-PW-Collections//01-js-masterclass//PlayPro//src//utils//testdatareader.ts";
// TEST_DATA_PATH value is coming from constants file


// Utility to load and parse JSON once
function loadTestData(): any {
    if (!fs.existsSync(testDataPath)) {
        throw new Error(`Test data file not found: ${testDataPath}`);
    }

    const rawData = fs.readFileSync(testDataPath, "utf-8"); // json data is stored as string in rawData
    return JSON.parse(rawData); // converting string to json object via JSON.parse
}

// method to get json value [simple json like {"base_url": "https://example.com"}];
export function getTestData(key: string): string {

    const testData = loadTestData();

    if (!(key in testData)) {
        throw new Error(`Key "${key}" not found in test data`);
    }

    if (typeof testData[key] !== "string") {
        throw new Error(`Key "${key}" does not contain a string value`);
    }


    return testData[key];
}

// Method to get JSON object
export function getJsonObject(key: string): Record<string, any> {

    const testData = loadTestData();

    if (!(key in testData)) {
        throw new Error(`Key "${key}" not found in test data`);
    }

    const value = testData[key];
    if (typeof value !== "object" || Array.isArray(value)) {
        throw new Error(`Key "${key}" does not contain a JSON object`);
    }

    return value;
}

// Method to get JSON array
export function getJsonArray(key: string): any[] {
    const testData = loadTestData();

    if (!(key in testData)) {
        throw new Error(`Key "${key}" not found in test data`);
    }

    const value = testData[key];
    if (!Array.isArray(value)) {
        throw new Error(`Key "${key}" does not contain a JSON array`);
    }

    return value;
}

******************************code ends here *****************************



üîπ Tera code me ye ho raha hai

const rawData = fs.readFileSync(testDataPath, "utf-8");
return JSON.parse(rawData);

üëâ Yaani tu jo bhi JSON file me likhega, usko string me read karega aur JSON.parse karega.
Aur JSON.parse har valid JSON ko parse kar sakta hai ‚Äî chahe wo object {} ho ya array [].

üîπ JSON ke 2 root types ho sakte hain

Object root { ... }
Example:

{
    "name": "Rahul",
    "age": 25
}

Parse hone ke baad JS object ban jaata hai.

const data = JSON.parse('{"name": "Rahul"}');
console.log(typeof data); // object


2. Array root [ ... ]
Example:

[
    { "name": "Rahul" },
    { "name": "Sid" }
]

Parse hone ke baad JS array ban jaata hai.

const data = JSON.parse('[{"name":"Rahul"},{"name":"Sid"}]');
console.log(Array.isArray(data)); // true

üëâ Yaani haan, agar file square brackets [] se start hoti hai tab bhi ye code perfectly chalega, 
   kyunki JSON.parse usko JS array bana dega.


üîπ Lekin dikkat yaha aayegi

Tere getTestData, getJsonObject, aur getJsonArray functions assume karte hain ki root hamesha object {} hoga 
jisme tu key pass karega.

if (!(key in testData)) {
    throw new Error(`Key "${key}" not found`);
}

Agar root JSON array hai ([ ... ]), to uspe key in testData chalega hi nahi 
(kyunki wo object nahi hai, array hai). Aur turant error aayega.

üîπ Example

JSON file:

[
    { "username": "rahul" },
    { "username": "sid" }
]

Phir:

  const data = loadTestData();
  console.log(data[0].username); // chalega ‚úÖ

Lekin:

getTestData("base_url"); // ‚ùå Error

‚úÖ Summary

    - JSON.parse dono ko parse kar sakta hai ‚Äî {} bhi aur [] bhi.

    - Tera code abhi sirf object root JSON ke liye design hua hai.

    - Agar root me array hoga, to getTestData("...") type functions kaam nahi karenge, kyunki wo key lookup karte hain.
 